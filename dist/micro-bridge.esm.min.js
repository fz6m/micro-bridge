/*!
 * micro-bridge v1.0.0
 * (c) 2020-2021 fz6m
 * Released under the MIT License.
 */
import t from"lodash.set";import n from"lodash.get";import r from"lodash.isequal";n(window,"_$store")||t(window,"_$store",{});var e=function(t,n){return"_$"+t+"."+n};function o(t,n){for(var r=0,e=n.length,o=t.length;r<e;r++,o++)t[o]=n[r];return t}var i=function(t,n){return h(t,n)||[]},u=function(t,n){for(var r=[],e=2;e<arguments.length;e++)r[e-2]=arguments[e];var o=i(t,n);o.forEach((function(t){try{t.apply(void 0,r)}catch(t){}}))},f=function(t){return{get:function(n){return i(n,t)},add:function(n,r){return function(t,n,r){var e=i(t,r);if(!~e.indexOf(n)){var u=o(o([],e),[n]);v(t,u,r)}}(n,r,t)},destory:function(n){return function(t,n){v(t,[],n)}(n,t)},delete:function(n,r){return function(t,n,r){var e=i(t,r),o=e.indexOf(n);return!!~o&&(e.splice(o,1),v(t,e,r),!0)}(n,r,t)},dispacth:function(n){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return u.apply(void 0,o([n,t],r))}}},c=f("value_subscribe"),a={$on:c.add,$destory:c.destory,$delete:c.delete},d=function(){return n(window,"_$store")||{}},s=function(t){var r=d();return n(r,t)},l=function(n,e){!function(t,n,e){r(e,n)||c.dispacth(t,n,e)}(n,e,s(n));var o=d();t(o,n,e)},v=function(t,n,r){var o=e(r,t);l(o,n)},h=function(t,n){var r=e(n,t);return s(r)},p={getStore:d,get:s,set:l,getWithScope:h,setWithScope:v},$=f("subscribe"),g={$on:$.add,$off:$.destory,$emit:function(t,n){$.dispacth(t,n)},$delete:$.delete};export{p as Store,g as StoreBus,a as StoreChange};
